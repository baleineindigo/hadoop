{"paragraphs":[{"text":"// Mysql DB와 연결하기\n// 기본 설정 : 드라이버, 경로, url, 루트,패스워드\nval driver=\"com.mysql.cj.jdbc.Driver\"\nval path=\"C:/HadoopEco/spark-2.4.7-bin-hadoop2.7/data/flight-data/jdbc/my-sqlite.db\"\nval url=\"jdbc:mysql://127.0.0.1:3306/scott?serverTimezone=UTC&useUnicode=yes&characterEncoding=UTF-8&user=root&password=1234\"","user":"anonymous","dateUpdated":"2021-01-03T18:47:38+0900","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"driver: String = com.mysql.cj.jdbc.Driver\r\npath: String = C:/HadoopEco/spark-2.4.7-bin-hadoop2.7/data/flight-data/jdbc/my-sqlite.db\r\nurl: String = jdbc:mysql://127.0.0.1:3306/scott?serverTimezone=UTC&useUnicode=yes&characterEncoding=UTF-8&user=root&password=1234\n"}]},"apps":[],"jobName":"paragraph_1609586584260_1461683675","id":"20210102-143948_1467980181","dateCreated":"2021-01-02T20:23:04+0900","dateStarted":"2021-01-03T17:29:02+0900","dateFinished":"2021-01-03T17:29:03+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11714"},{"text":"%sql\nSHOW DATABASES\n","user":"anonymous","dateUpdated":"2021-01-03T18:47:38+0900","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"databaseName":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"databaseName\ndefault\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1609586584262_-1243351445","id":"20210102-145117_577020328","dateCreated":"2021-01-02T20:23:04+0900","dateStarted":"2021-01-03T18:12:52+0900","dateFinished":"2021-01-03T18:12:52+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11715"},{"text":"%sql\n-- 데이터베이스 생성하기\nCREATE DATABASE some_db","user":"anonymous","dateUpdated":"2021-01-03T18:47:38+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Database 'some_db' already exists;\nset zeppelin.spark.sql.stacktrace = true to see full stacktrace"}]},"apps":[],"jobName":"paragraph_1609586584269_-124795276","id":"20210102-200733_1999334789","dateCreated":"2021-01-02T20:23:04+0900","dateStarted":"2021-01-03T17:32:30+0900","dateFinished":"2021-01-03T17:32:30+0900","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:11716"},{"text":"%sql\n-- 데이터 베이스 설정\nUSE some_db","user":"anonymous","dateUpdated":"2021-01-03T18:47:38+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1609586584270_1375706274","id":"20210102-200733_1562894111","dateCreated":"2021-01-02T20:23:04+0900","dateStarted":"2021-01-03T17:33:07+0900","dateFinished":"2021-01-03T17:33:08+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11717"},{"text":"%sql\nSELECT current_database()\n-- some_db 사용중","user":"anonymous","dateUpdated":"2021-01-03T18:47:38+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"current_database()":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"current_database()\ndefault\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1609662792989_1900612310","id":"20210103-173312_358983198","dateCreated":"2021-01-03T17:33:12+0900","dateStarted":"2021-01-03T17:58:39+0900","dateFinished":"2021-01-03T17:58:39+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11718"},{"text":"%sql\n-- 기본 데이터 베이스로 돌아가기\nUSE default","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1609662902444_-339820387","id":"20210103-173502_900983531","dateCreated":"2021-01-03T17:35:02+0900","dateStarted":"2021-01-03T18:12:43+0900","dateFinished":"2021-01-03T18:12:43+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11719"},{"text":"%sql\n-- 데이터 베이스 제거하기\nDROP DATABASE IF EXISTS some_db","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1609586584271_-905680120","id":"20210102-200732_1270776846","dateCreated":"2021-01-02T20:23:04+0900","dateStarted":"2021-01-03T17:58:46+0900","dateFinished":"2021-01-03T17:58:46+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11720"},{"text":"%md\n#### select 구문\n스파크 쿼리는 ANSI-SQL 요건 충족.\n","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>select 구문</h4>\n<p>스파크 쿼리는 ANSI-SQL 요건 충족.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1609663170408_168861706","id":"20210103-173930_1038306830","dateCreated":"2021-01-03T17:39:30+0900","dateStarted":"2021-01-03T18:12:37+0900","dateFinished":"2021-01-03T18:12:37+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11721"},{"text":"%sql\n-- CREATE TABLE flights(\n--     DEST_COUNTRY_NAME STRING,ORIGIN_COUNTRY_NAME STRING,count LONG)\n-- USING JSON OPTIONS(path 'C:/HadoopEco/spark-2.4.7-bin-hadoop2.7/data/flight-data/json/2015-summary.json')\nSELECT DEST_COUNTRY_NAME,ORIGIN_COUNTRY_NAME FROM flights","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{"columns":[{"name":"DEST_COUNTRY_NAME","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"ORIGIN_COUNTRY_NAME","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"DEST_COUNTRY_NAME":"string","ORIGIN_COUNTRY_NAME":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":true,"showPagination":true,"showAggregationFooter":true},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"DEST_COUNTRY_NAME","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"ORIGIN_COUNTRY_NAME","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"DEST_COUNTRY_NAME\tORIGIN_COUNTRY_NAME\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1609664573696_-203200723","id":"20210103-180253_1806935062","dateCreated":"2021-01-03T18:02:53+0900","dateStarted":"2021-01-03T18:12:19+0900","dateFinished":"2021-01-03T18:12:19+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11722"},{"text":"%sql\n-- case when...then 구문\nSELECT \n    CASE WHEN DEST_COUNTRY_NAME=\"UNITED STATES\" THEN 1\n         WHEN DEST_COUNTRY_NAME=\"Egypt\" THEN 0\n         ElSE -1 END\nFROM flights\n","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"CASE WHEN (DEST_COUNTRY_NAME = UNITED STATES) THEN 1 WHEN (DEST_COUNTRY_NAME = Egypt) THEN 0 ELSE -1 END","visible":true,"width":"*","sort":{"priority":0,"direction":"asc"},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"CASE WHEN (DEST_COUNTRY_NAME = UNITED STATES) THEN 1 WHEN (DEST_COUNTRY_NAME = Egypt) THEN 0 ELSE -1 END":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CASE WHEN (DEST_COUNTRY_NAME = UNITED STATES) THEN 1 WHEN (DEST_COUNTRY_NAME = Egypt) THEN 0 ELSE -1 END\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1609663169956_-356531512","id":"20210103-173929_1783542359","dateCreated":"2021-01-03T17:39:29+0900","dateStarted":"2021-01-03T18:14:47+0900","dateFinished":"2021-01-03T18:14:47+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11723"},{"text":"%md\n## 고급 주제\n1) 복합 데이터 타입\n2) 함수\n3) 서브 쿼리\n","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>고급 주제</h2>\n<p>1) 복합 데이터 타입<br/>2) 함수<br/>3) 서브 쿼리</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1609663213604_1102928171","id":"20210103-174013_2016795829","dateCreated":"2021-01-03T17:40:13+0900","dateStarted":"2021-01-03T18:15:29+0900","dateFinished":"2021-01-03T18:15:30+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11724"},{"text":"%sql\n-- 1-1) 구조체\nCREATE VIEW IF NOT EXISTS nested_data AS\n    SELECT (DEST_COUNTRY_NAME,ORIGIN_COUNTRY_NAME) as country, count FROM flights\n\nSELECT country.DEST_COUNTRY_NAME, country.ORIGIN_COUNTRY_NAME, count FROM nested_data\n\nSELECT * FROM nested_data\nSELECT country.*,count FROM nested_data","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"DEST_COUNTRY_NAME":"string","ORIGIN_COUNTRY_NAME":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"DEST_COUNTRY_NAME\tORIGIN_COUNTRY_NAME\tcount\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1609586584272_-1179287151","id":"20210102-200731_978793127","dateCreated":"2021-01-02T20:23:04+0900","dateStarted":"2021-01-03T18:19:39+0900","dateFinished":"2021-01-03T18:19:39+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11725"},{"text":"%sql\n-- 1-2) 리스트\n-- 리스트를 만드는 collect_list, 중복없는 배열을 만드는 collect_set 함수로 만들기.\n-- 단, 두 함수는 집계 연산에만 사용 가능\nSELECT DEST_COUNTRY_NAME as new_name,collect_list(count) as flights_counts,\n        collect_set(ORIGIN_COUNTRY_NAME) as origin_set\nFROM flights\nGROUP BY DEST_COUNTRY_NAME\n\n-- 직접 배열 생성\nSELECT DEST_COUNTRY_NAME,ARRAY(1,2,3) FROM flights\n\n-- 파이썬과 유사한 배열 쿼리 구문으로 리스트의 특정 위치의 데이터를 쿼리 가능\n SELECT DEST_COUNTRY_NAME as new_name, collect_list(count)[0]\n FROM flights\n GROUP BY DEST_COUNTRY_NAME\n \n--  explode 함수로 배열을 려러 로우로 변환\nCREATE OR REPLACE TEMP VIEW flights_agg AS\n    SELECT DEST_COUNTRY_NAME,collect_list(count) as collected_counts\n    FROM flights\n    GROUP BY DEST_COUNTRY_NAME\n-- 복합 데이터 타입 컬럼에 EXPLODE 함수를 사용하여 저장된 배열의 모든 값을 단일 로우 형태로 분해\n-- explode 함수는 collect 함수와 정확히 반대로 동작. collect 함수 실행 전 DataFrame과 동일한 결과를 반환\nSELECT explode(collected_counts),DEST_COUNTRY_NAME FROM flights_agg","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col":"string","DEST_COUNTRY_NAME":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"col\tDEST_COUNTRY_NAME\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1609665460406_-1992605089","id":"20210103-181740_1539518568","dateCreated":"2021-01-03T18:17:40+0900","dateStarted":"2021-01-03T18:30:54+0900","dateFinished":"2021-01-03T18:30:55+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11726"},{"text":"%sql\n-- 2) 함수\n스파크 전체 함수 목록\nSHOW FUNCTIONS\n\n-- 스파크 내장 시스템 함수, 사용자 함수\nSHOW SYSTEM FUNCTIONS\n\n-- 사용자 정의 함수\nSHOW USER FUNCTIONS\n\n-- 모든 SHOW 명령에 와일드카드 문자가 포함된 문자열을 사용하려 결과 필터링\n-- S로 시작하는 모든 함수를 필터링하는 방법\nSHOW FUNCTIONS \"s*\"\nSHOW FUNCTIONS LIKE \"ab*\"\n","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"function":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":85.9978,"optionOpen":false}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1609666267298_-1381217942","id":"20210103-183107_1478310975","dateCreated":"2021-01-03T18:31:07+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15966","dateFinished":"2021-01-03T18:35:42+0900","dateStarted":"2021-01-03T18:35:42+0900","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"function\nabs\n"},{"type":"TEXT","data":""}]}},{"text":"// 사용자 정의 함수\n// 스칼라로 함수 정의\ndef power3(number:Double):\n    Double=number*number*number\nspark.udf.register(\"power3\",power3(_:Double):Double)","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1609666788491_-1745706316","id":"20210103-183948_856496461","dateCreated":"2021-01-03T18:39:48+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18999","dateFinished":"2021-01-03T18:40:00+0900","dateStarted":"2021-01-03T18:39:59+0900","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"power3: (number: Double)Double\r\nres5: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,DoubleType,Some(List(DoubleType)))\n"}]}},{"text":"%sql\n-- sql로 함수 불러와서 실행\nSELECT count,power3(count) FROM flights","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"count":"string","UDF:power3(cast(count as double))":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1609665594857_-1999877146","id":"20210103-181954_1777169949","dateCreated":"2021-01-03T18:19:54+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11727","dateFinished":"2021-01-03T18:40:30+0900","dateStarted":"2021-01-03T18:40:30+0900","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count\tUDF:power3(cast(count as double))\n"},{"type":"TEXT","data":""}]}},{"text":"%sql\n-- 3-1) 상호연관 서브쿼리 : 서브쿼리의 정보를 보완하기 위해 쿼리의 외부 범위에 있는 일부 정보 사용\n-- 목적지 국가에서 되돌아올 수 있는 항공편이 있는지 알고 싶을 때.\nSELECT * FROM flights f1\nWHERE EXISTS (SELECT 1 FROM flights f2\n                WhERE  f1.DEST_COUNTRY_NAME=f2.ORIGIN_COUNTRY_NAME)\nAND EXISTS (SELECT 1 FROM flights f2\n                WhERE  f2.DEST_COUNTRY_NAME=f1.ORIGIN_COUNTRY_NAME)","user":"anonymous","dateUpdated":"2021-01-03T18:47:39+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"DEST_COUNTRY_NAME":"string","ORIGIN_COUNTRY_NAME":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1609665596138_1991650791","id":"20210103-181956_1468819755","dateCreated":"2021-01-03T18:19:56+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11728","dateFinished":"2021-01-03T18:45:34+0900","dateStarted":"2021-01-03T18:45:33+0900","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"DEST_COUNTRY_NAME\tORIGIN_COUNTRY_NAME\tcount\n"},{"type":"TEXT","data":""}]}},{"text":"%sql\n-- 3-1) 비상호연관 서브쿼리 : 외부 정보 사용하지 않음\nSELECT *,(SELECT max(count) FROM flights) AS maximum FROM flights\n","user":"anonymous","dateUpdated":"2021-01-03T18:47:40+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"DEST_COUNTRY_NAME":"string","ORIGIN_COUNTRY_NAME":"string","count":"string","maximum":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1609666967184_1000299865","id":"20210103-184247_689708905","dateCreated":"2021-01-03T18:42:47+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19680","dateFinished":"2021-01-03T18:47:10+0900","dateStarted":"2021-01-03T18:47:09+0900","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"DEST_COUNTRY_NAME\tORIGIN_COUNTRY_NAME\tcount\tmaximum\n"},{"type":"TEXT","data":""}]}}],"name":"part2_ch10_스파크SQL2","id":"2FUZ97Y4Y","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}